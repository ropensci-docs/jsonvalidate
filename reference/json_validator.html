<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Create a validator that can validate multiple json files."><title>Create a json validator — json_validator • jsonvalidate</title><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a json validator — json_validator"><meta property="og:description" content="Create a validator that can validate multiple json files."><meta property="og:image" content="https://docs.ropensci.org/jsonvalidate/logo.png"><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css"><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript><!-- End Matomo Code --></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">jsonvalidate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.4.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="../articles/jsonvalidate.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/jsonvalidate/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create a json validator</h1>
      <small class="dont-index">Source: <a href="https://github.com/ropensci/jsonvalidate/blob/HEAD/R/validate.R" class="external-link"><code>R/validate.R</code></a></small>
      <div class="d-none name"><code>json_validator.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create a validator that can validate multiple json files.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">json_validator</span><span class="op">(</span><span class="va">schema</span>, engine <span class="op">=</span> <span class="st">"imjv"</span>, reference <span class="op">=</span> <span class="cn">NULL</span>, strict <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>schema</dt>
<dd><p>Contents of the json schema, or a filename
containing a schema.</p></dd>


<dt>engine</dt>
<dd><p>Specify the validation engine to use.  Options are
"imjv" (the default; which uses "is-my-json-valid") and "ajv"
(Another JSON Schema Validator).  The latter supports more
recent json schema features.</p></dd>


<dt>reference</dt>
<dd><p>Reference within schema to use for validating against a
sub-schema instead of the full schema passed in. For example
if the schema has a 'definitions' list including a definition for a
'Hello' object, one could pass "#/definitions/Hello" and the validator
would check that the json is a valid "Hello" object. Only available if
<code>engine = "ajv"</code>.</p></dd>


<dt>strict</dt>
<dd><p>Set whether the schema should be parsed strictly or not.
If in strict mode schemas will error to "prevent any unexpected
behaviours or silently ignored mistakes in user schema". For example
it will error if encounters unknown formats or unknown keywords. See
https://ajv.js.org/strict-mode.html for details. Only available in
<code>engine = "ajv"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A function that can be used to validate a
schema. Additionally, the function has two attributes assigned:
<code>v8</code> which is the javascript context (used internally) and
<code>engine</code>, which contains the name of the engine used.</p>
    </div>
    <div class="section level2">
    <h2 id="validation-engines">Validation Engines<a class="anchor" aria-label="anchor" href="#validation-engines"></a></h2>
    


<p>We support two different json validation engines, <code>imjv</code>
("is-my-json-valid") and <code>ajv</code> ("Another JSON
Validator"). <code>imjv</code> was the original validator included in
the package and remains the default for reasons of backward
compatibility. However, users are encouraged to migrate to
<code>ajv</code> as with it we support many more features, including
nested schemas that span multiple files, meta schema versions
later than draft-04, validating using a subschema, and
validating a subset of an input data object.</p>
<p>If your schema uses these features we will print a message to
screen indicating that you should update when running
interactively. We do not use a warning here as this will be
disruptive to users. You can disable the message by setting the
option <code>jsonvalidate.no_note_imjv</code> to <code>TRUE</code>. Consider using
<code><a href="https://withr.r-lib.org/reference/with_options.html" class="external-link">withr::with_options()</a></code> (or simply <code><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages()</a></code>) to
scope this option if you want to quieten it within code you do
not control.  Alternatively, setting the option
<code>jsonvalidate.no_note_imjv</code> to <code>FALSE</code> will print the message
even noninteractively.</p>
<p>Updating the engine should be simply a case of adding <code>engine = "ajv"</code> to your <code>json_validator</code> or <code>json_validate</code>
calls, but you may see some issues when doing so.</p><ul><li><p>Your json now fails validation: We've seen this where schemas
spanned several files and are silently ignored. By including
these, your data may now fail validation and you will need to
either fix the data or the schema.</p></li>
<li><p>Your code depended on the exact payload returned by <code>imjv</code>: If
you are inspecting the error result and checking numbers of
errors, or even the columns used to describe the errors, you
will likely need to update your code to accommodate the slightly
different format of <code>ajv</code></p></li>
<li><p>Your schema is simply invalid: If you reference an invalid
metaschema for example, jsonvalidate will fail</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="using-multiple-files">Using multiple files<a class="anchor" aria-label="anchor" href="#using-multiple-files"></a></h2>
    


<p>Multiple files are supported.  You can have a schema that references
a file <code>child.json</code> using <code>{"$ref": "child.json"}</code>---in this case if
<code>child.json</code> includes an <code>id</code> or <code>$id</code> element it will be silently
dropped and the filename used to reference the schema will be used
as the schema id.</p>
<p>The support is currently quite limited - it will not (yet) read
sub-child schemas relative to child schema <code>$id</code> url, and
does not support reading from URLs (only local files are
supported).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># A simple schema example:</span></span></span>
<span class="r-in"><span><span class="va">schema</span> <span class="op">&lt;-</span> <span class="st">'{</span></span></span>
<span class="r-in"><span><span class="st">    "$schema": "http://json-schema.org/draft-04/schema#",</span></span></span>
<span class="r-in"><span><span class="st">    "title": "Product",</span></span></span>
<span class="r-in"><span><span class="st">    "description": "A product from Acme\'s catalog",</span></span></span>
<span class="r-in"><span><span class="st">    "type": "object",</span></span></span>
<span class="r-in"><span><span class="st">    "properties": {</span></span></span>
<span class="r-in"><span><span class="st">        "id": {</span></span></span>
<span class="r-in"><span><span class="st">            "description": "The unique identifier for a product",</span></span></span>
<span class="r-in"><span><span class="st">            "type": "integer"</span></span></span>
<span class="r-in"><span><span class="st">        },</span></span></span>
<span class="r-in"><span><span class="st">        "name": {</span></span></span>
<span class="r-in"><span><span class="st">            "description": "Name of the product",</span></span></span>
<span class="r-in"><span><span class="st">            "type": "string"</span></span></span>
<span class="r-in"><span><span class="st">        },</span></span></span>
<span class="r-in"><span><span class="st">        "price": {</span></span></span>
<span class="r-in"><span><span class="st">            "type": "number",</span></span></span>
<span class="r-in"><span><span class="st">            "minimum": 0,</span></span></span>
<span class="r-in"><span><span class="st">            "exclusiveMinimum": true</span></span></span>
<span class="r-in"><span><span class="st">        },</span></span></span>
<span class="r-in"><span><span class="st">        "tags": {</span></span></span>
<span class="r-in"><span><span class="st">            "type": "array",</span></span></span>
<span class="r-in"><span><span class="st">            "items": {</span></span></span>
<span class="r-in"><span><span class="st">                "type": "string"</span></span></span>
<span class="r-in"><span><span class="st">            },</span></span></span>
<span class="r-in"><span><span class="st">            "minItems": 1,</span></span></span>
<span class="r-in"><span><span class="st">            "uniqueItems": true</span></span></span>
<span class="r-in"><span><span class="st">        }</span></span></span>
<span class="r-in"><span><span class="st">    },</span></span></span>
<span class="r-in"><span><span class="st">    "required": ["id", "name", "price"]</span></span></span>
<span class="r-in"><span><span class="st">}'</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a validator function</span></span></span>
<span class="r-in"><span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu">jsonvalidate</span><span class="fu">::</span><span class="fu">json_validator</span><span class="op">(</span><span class="va">schema</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Test if some (invalid) json conforms to the schema</span></span></span>
<span class="r-in"><span><span class="fu">v</span><span class="op">(</span><span class="st">"{}"</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"errors")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        field     message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    data.id is required</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  data.name is required</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 data.price is required</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Test if some (valid) json conforms to the schema</span></span></span>
<span class="r-in"><span><span class="fu">v</span><span class="op">(</span><span class="st">'{</span></span></span>
<span class="r-in"><span><span class="st">    "id": 1,</span></span></span>
<span class="r-in"><span><span class="st">    "name": "A green door",</span></span></span>
<span class="r-in"><span><span class="st">    "price": 12.50,</span></span></span>
<span class="r-in"><span><span class="st">    "tags": ["home", "green"]</span></span></span>
<span class="r-in"><span><span class="st">}'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using features from draft-06 or draft-07 requires the ajv engine:</span></span></span>
<span class="r-in"><span><span class="va">schema</span> <span class="op">&lt;-</span> <span class="st">"{</span></span></span>
<span class="r-in"><span><span class="st">  '$schema': 'http://json-schema.org/draft-06/schema#',</span></span></span>
<span class="r-in"><span><span class="st">  'type': 'object',</span></span></span>
<span class="r-in"><span><span class="st">  'properties': {</span></span></span>
<span class="r-in"><span><span class="st">    'a': {</span></span></span>
<span class="r-in"><span><span class="st">      'const': 'foo'</span></span></span>
<span class="r-in"><span><span class="st">    }</span></span></span>
<span class="r-in"><span><span class="st">  }</span></span></span>
<span class="r-in"><span><span class="st">}"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create the validator</span></span></span>
<span class="r-in"><span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu">jsonvalidate</span><span class="fu">::</span><span class="fu">json_validator</span><span class="op">(</span><span class="va">schema</span>, engine <span class="op">=</span> <span class="st">"ajv"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This confirms to the schema</span></span></span>
<span class="r-in"><span><span class="fu">v</span><span class="op">(</span><span class="st">'{"a": "foo"}'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># But this does not</span></span></span>
<span class="r-in"><span><span class="fu">v</span><span class="op">(</span><span class="st">'{"a": "bar"}'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg"></div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul></div>
                    <div class="col-md-3 col-sm-4">
                        <ul><h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul></div>
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul></div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer></div>

  

  

  </body></html>

