<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="jsonvalidate">
<title>Introduction to jsonvalidate • jsonvalidate</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to jsonvalidate">
<meta property="og:description" content="jsonvalidate">
<meta property="og:image" content="https://docs.ropensci.org/jsonvalidate/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">jsonvalidate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.4.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="active nav-item">
  <a class="nav-link" href="../articles/jsonvalidate.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/jsonvalidate/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to jsonvalidate</h1>
                        <h4 data-toc-skip class="author">Rich FitzJohn</h4>
            
            <h4 data-toc-skip class="date">2024-03-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/jsonvalidate/blob/HEAD/vignettes/jsonvalidate.Rmd" class="external-link"><code>vignettes/jsonvalidate.Rmd</code></a></small>
      <div class="d-none name"><code>jsonvalidate.Rmd</code></div>
    </div>

    
    
<p>This package wraps <a href="https://github.com/mafintosh/is-my-json-valid" class="external-link">is-my-json-valid</a> using <a href="https://cran.r-project.org/package=V8" class="external-link">V8</a> to do JSON schema validation in R.</p>
<p>You need a JSON schema file; see <a href="http://json-schema.org" class="external-link">json-schema.org</a> for details on writing these. Often someone else has done the hard work of writing one for you, and you can just check that the JSON you are producing or consuming conforms to the schema.</p>
<p>The examples below come from the <a href="http://json-schema.org/learn/getting-started-step-by-step.html" class="external-link">JSON schema website</a></p>
<p>They describe a JSON based product catalogue, where each product has an id, a name, a price, and an optional set of tags. A JSON representation of a product is:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"id"</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"name"</span><span class="fu">:</span> <span class="st">"A green door"</span><span class="fu">,</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"price"</span><span class="fu">:</span> <span class="fl">12.50</span><span class="fu">,</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"tags"</span><span class="fu">:</span> <span class="ot">[</span><span class="st">"home"</span><span class="ot">,</span> <span class="st">"green"</span><span class="ot">]</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>The schema that they derive looks like this:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"$schema"</span><span class="fu">:</span> <span class="st">"http://json-schema.org/draft-04/schema#"</span><span class="fu">,</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"title"</span><span class="fu">:</span> <span class="st">"Product"</span><span class="fu">,</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"description"</span><span class="fu">:</span> <span class="st">"A product from Acme's catalog"</span><span class="fu">,</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"type"</span><span class="fu">:</span> <span class="st">"object"</span><span class="fu">,</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"properties"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"id"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"description"</span><span class="fu">:</span> <span class="st">"The unique identifier for a product"</span><span class="fu">,</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"type"</span><span class="fu">:</span> <span class="st">"integer"</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">},</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"name"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"description"</span><span class="fu">:</span> <span class="st">"Name of the product"</span><span class="fu">,</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"type"</span><span class="fu">:</span> <span class="st">"string"</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">},</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"price"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"type"</span><span class="fu">:</span> <span class="st">"number"</span><span class="fu">,</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"minimum"</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"exclusiveMinimum"</span><span class="fu">:</span> <span class="kw">true</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">},</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"tags"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"type"</span><span class="fu">:</span> <span class="st">"array"</span><span class="fu">,</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"items"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>                <span class="dt">"type"</span><span class="fu">:</span> <span class="st">"string"</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>            <span class="fu">},</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"minItems"</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"uniqueItems"</span><span class="fu">:</span> <span class="kw">true</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">},</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"required"</span><span class="fu">:</span> <span class="ot">[</span><span class="st">"id"</span><span class="ot">,</span> <span class="st">"name"</span><span class="ot">,</span> <span class="st">"price"</span><span class="ot">]</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>This ensures the types of all fields, enforces presence of <code>id</code>, <code>name</code> and <code>price</code>, checks that the price is not negative and checks that if present <code>tags</code> is a unique list of strings.</p>
<p>There are two ways of passing the schema in to R; as a string or as a filename. If you have a large schema loading as a file will generally be easiest! Here’s a string representing the schema (watch out for escaping quotes):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">schema</span> <span class="op">&lt;-</span> <span class="st">'{</span></span>
<span><span class="st">    "$schema": "http://json-schema.org/draft-04/schema#",</span></span>
<span><span class="st">    "title": "Product",</span></span>
<span><span class="st">    "description": "A product from Acme\'s catalog",</span></span>
<span><span class="st">    "type": "object",</span></span>
<span><span class="st">    "properties": {</span></span>
<span><span class="st">        "id": {</span></span>
<span><span class="st">            "description": "The unique identifier for a product",</span></span>
<span><span class="st">            "type": "integer"</span></span>
<span><span class="st">        },</span></span>
<span><span class="st">        "name": {</span></span>
<span><span class="st">            "description": "Name of the product",</span></span>
<span><span class="st">            "type": "string"</span></span>
<span><span class="st">        },</span></span>
<span><span class="st">        "price": {</span></span>
<span><span class="st">            "type": "number",</span></span>
<span><span class="st">            "minimum": 0,</span></span>
<span><span class="st">            "exclusiveMinimum": true</span></span>
<span><span class="st">        },</span></span>
<span><span class="st">        "tags": {</span></span>
<span><span class="st">            "type": "array",</span></span>
<span><span class="st">            "items": {</span></span>
<span><span class="st">                "type": "string"</span></span>
<span><span class="st">            },</span></span>
<span><span class="st">            "minItems": 1,</span></span>
<span><span class="st">            "uniqueItems": true</span></span>
<span><span class="st">        }</span></span>
<span><span class="st">    },</span></span>
<span><span class="st">    "required": ["id", "name", "price"]</span></span>
<span><span class="st">}'</span></span></code></pre></div>
<p>Create a schema object, which can be used to validate a schema:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu">jsonvalidate</span><span class="fu">::</span><span class="va"><a href="../reference/json_schema.html">json_schema</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">schema</span><span class="op">)</span></span></code></pre></div>
<p>If we’d saved the json to a file, this would work too:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">schema</span>, <span class="va">path</span><span class="op">)</span></span>
<span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu">jsonvalidate</span><span class="fu">::</span><span class="va"><a href="../reference/json_schema.html">json_schema</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span></code></pre></div>
<p>The returned object is a function that takes as its first argument a json string, or a filename of a json file. The empty list will fail validation because it does not contain any of the required fields:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span><span class="op">$</span><span class="fu">validate</span><span class="op">(</span><span class="st">"{}"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
<p>To get more information on why the validation fails, add <code>verbose = TRUE</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span><span class="op">$</span><span class="fu">validate</span><span class="op">(</span><span class="st">"{}"</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## attr(,"errors")</span></span>
<span><span class="co">##   instancePath schemaPath  keyword missingProperty</span></span>
<span><span class="co">## 1              #/required required              id</span></span>
<span><span class="co">## 2              #/required required            name</span></span>
<span><span class="co">## 3              #/required required           price</span></span>
<span><span class="co">##                               message          schema</span></span>
<span><span class="co">## 1    must have required property 'id' id, name, price</span></span>
<span><span class="co">## 2  must have required property 'name' id, name, price</span></span>
<span><span class="co">## 3 must have required property 'price' id, name, price</span></span>
<span><span class="co">##                      parentSchema.$schema parentSchema.title</span></span>
<span><span class="co">## 1 http://json-schema.org/draft-04/schema#            Product</span></span>
<span><span class="co">## 2 http://json-schema.org/draft-04/schema#            Product</span></span>
<span><span class="co">## 3 http://json-schema.org/draft-04/schema#            Product</span></span>
<span><span class="co">##        parentSchema.description parentSchema.type</span></span>
<span><span class="co">## 1 A product from Acme's catalog            object</span></span>
<span><span class="co">## 2 A product from Acme's catalog            object</span></span>
<span><span class="co">## 3 A product from Acme's catalog            object</span></span>
<span><span class="co">##   parentSchema.properties.id.description parentSchema.properties.id.type</span></span>
<span><span class="co">## 1    The unique identifier for a product                         integer</span></span>
<span><span class="co">## 2    The unique identifier for a product                         integer</span></span>
<span><span class="co">## 3    The unique identifier for a product                         integer</span></span>
<span><span class="co">##   parentSchema.properties.name.description parentSchema.properties.name.type</span></span>
<span><span class="co">## 1                      Name of the product                            string</span></span>
<span><span class="co">## 2                      Name of the product                            string</span></span>
<span><span class="co">## 3                      Name of the product                            string</span></span>
<span><span class="co">##   parentSchema.properties.price.type parentSchema.properties.price.minimum</span></span>
<span><span class="co">## 1                             number                                     0</span></span>
<span><span class="co">## 2                             number                                     0</span></span>
<span><span class="co">## 3                             number                                     0</span></span>
<span><span class="co">##   parentSchema.properties.price.exclusiveMinimum</span></span>
<span><span class="co">## 1                                           TRUE</span></span>
<span><span class="co">## 2                                           TRUE</span></span>
<span><span class="co">## 3                                           TRUE</span></span>
<span><span class="co">##   parentSchema.properties.tags.type parentSchema.properties.tags.type</span></span>
<span><span class="co">## 1                             array                            string</span></span>
<span><span class="co">## 2                             array                            string</span></span>
<span><span class="co">## 3                             array                            string</span></span>
<span><span class="co">##   parentSchema.properties.tags.minItems</span></span>
<span><span class="co">## 1                                     1</span></span>
<span><span class="co">## 2                                     1</span></span>
<span><span class="co">## 3                                     1</span></span>
<span><span class="co">##   parentSchema.properties.tags.uniqueItems parentSchema.required dataPath</span></span>
<span><span class="co">## 1                                     TRUE       id, name, price         </span></span>
<span><span class="co">## 2                                     TRUE       id, name, price         </span></span>
<span><span class="co">## 3                                     TRUE       id, name, price</span></span></code></pre>
<p>The attribute “errors” is a data.frame and is present only when the json fails validation. The error messages come straight from <code>ajv</code> and they may not always be that informative.</p>
<p>Alternatively, to throw an error if the json does not validate, add <code>error = TRUE</code> to the call:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span><span class="op">$</span><span class="fu">validate</span><span class="op">(</span><span class="st">"{}"</span>, error <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error: 3 errors validating json:</span></span>
<span><span class="co">##  -  (#/required): must have required property 'id'</span></span>
<span><span class="co">##  -  (#/required): must have required property 'name'</span></span>
<span><span class="co">##  -  (#/required): must have required property 'price'</span></span></code></pre>
<p>The JSON from the opening example works:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span><span class="op">$</span><span class="fu">validate</span><span class="op">(</span><span class="st">'{</span></span>
<span><span class="st">    "id": 1,</span></span>
<span><span class="st">    "name": "A green door",</span></span>
<span><span class="st">    "price": 12.50,</span></span>
<span><span class="st">    "tags": ["home", "green"]</span></span>
<span><span class="st">}'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>But if we tried to enter a negative price it would fail:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span><span class="op">$</span><span class="fu">validate</span><span class="op">(</span><span class="st">'{</span></span>
<span><span class="st">    "id": 1,</span></span>
<span><span class="st">    "name": "A green door",</span></span>
<span><span class="st">    "price": -1,</span></span>
<span><span class="st">    "tags": ["home", "green"]</span></span>
<span><span class="st">}'</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## attr(,"errors")</span></span>
<span><span class="co">##   instancePath                 schemaPath keyword params.comparison</span></span>
<span><span class="co">## 1       /price #/properties/price/minimum minimum                 &gt;</span></span>
<span><span class="co">##   params.limit     message schema parentSchema.type parentSchema.minimum</span></span>
<span><span class="co">## 1            0 must be &gt; 0      0            number                    0</span></span>
<span><span class="co">##   parentSchema.exclusiveMinimum data dataPath</span></span>
<span><span class="co">## 1                          TRUE   -1   /price</span></span></code></pre>
<p>…or duplicate tags:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span><span class="op">$</span><span class="fu">validate</span><span class="op">(</span><span class="st">'{</span></span>
<span><span class="st">    "id": 1,</span></span>
<span><span class="st">    "name": "A green door",</span></span>
<span><span class="st">    "price": 12.50,</span></span>
<span><span class="st">    "tags": ["home", "home"]</span></span>
<span><span class="st">}'</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## attr(,"errors")</span></span>
<span><span class="co">##   instancePath                    schemaPath     keyword params.i params.j</span></span>
<span><span class="co">## 1        /tags #/properties/tags/uniqueItems uniqueItems        0        1</span></span>
<span><span class="co">##                                                          message schema</span></span>
<span><span class="co">## 1 must NOT have duplicate items (items ## 1 and 0 are identical)   TRUE</span></span>
<span><span class="co">##   parentSchema.type parentSchema.type parentSchema.minItems</span></span>
<span><span class="co">## 1             array            string                     1</span></span>
<span><span class="co">##   parentSchema.uniqueItems       data dataPath</span></span>
<span><span class="co">## 1                     TRUE home, home    /tags</span></span></code></pre>
<p>or just basically everything wrong:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span><span class="op">$</span><span class="fu">validate</span><span class="op">(</span><span class="st">'{</span></span>
<span><span class="st">    "id": "identifier",</span></span>
<span><span class="st">    "name": 1,</span></span>
<span><span class="st">    "price": -1,</span></span>
<span><span class="st">    "tags": ["home", "home", 1]</span></span>
<span><span class="st">}'</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## attr(,"errors")</span></span>
<span><span class="co">##   instancePath                    schemaPath     keyword params.type</span></span>
<span><span class="co">## 1          /id          #/properties/id/type        type     integer</span></span>
<span><span class="co">## 2        /name        #/properties/name/type        type      string</span></span>
<span><span class="co">## 3       /price    #/properties/price/minimum     minimum        &lt;NA&gt;</span></span>
<span><span class="co">## 4      /tags/2  #/properties/tags/items/type        type      string</span></span>
<span><span class="co">## 5        /tags #/properties/tags/uniqueItems uniqueItems        &lt;NA&gt;</span></span>
<span><span class="co">##   params.comparison params.limit params.i params.j</span></span>
<span><span class="co">## 1              &lt;NA&gt;           NA       NA       NA</span></span>
<span><span class="co">## 2              &lt;NA&gt;           NA       NA       NA</span></span>
<span><span class="co">## 3                 &gt;            0       NA       NA</span></span>
<span><span class="co">## 4              &lt;NA&gt;           NA       NA       NA</span></span>
<span><span class="co">## 5              &lt;NA&gt;           NA        0        1</span></span>
<span><span class="co">##                                                          message  schema</span></span>
<span><span class="co">## 1                                                must be integer integer</span></span>
<span><span class="co">## 2                                                 must be string  string</span></span>
<span><span class="co">## 3                                                    must be &gt; 0       0</span></span>
<span><span class="co">## 4                                                 must be string  string</span></span>
<span><span class="co">## 5 must NOT have duplicate items (items ## 1 and 0 are identical)    TRUE</span></span>
<span><span class="co">##              parentSchema.description parentSchema.type parentSchema.minimum</span></span>
<span><span class="co">## 1 The unique identifier for a product           integer                   NA</span></span>
<span><span class="co">## 2                 Name of the product            string                   NA</span></span>
<span><span class="co">## 3                                &lt;NA&gt;            number                    0</span></span>
<span><span class="co">## 4                                &lt;NA&gt;            string                   NA</span></span>
<span><span class="co">## 5                                &lt;NA&gt;             array                   NA</span></span>
<span><span class="co">##   parentSchema.exclusiveMinimum parentSchema.type parentSchema.minItems</span></span>
<span><span class="co">## 1                            NA              &lt;NA&gt;                    NA</span></span>
<span><span class="co">## 2                            NA              &lt;NA&gt;                    NA</span></span>
<span><span class="co">## 3                          TRUE              &lt;NA&gt;                    NA</span></span>
<span><span class="co">## 4                            NA              &lt;NA&gt;                    NA</span></span>
<span><span class="co">## 5                            NA            string                     1</span></span>
<span><span class="co">##   parentSchema.uniqueItems          data dataPath</span></span>
<span><span class="co">## 1                       NA    identifier      /id</span></span>
<span><span class="co">## 2                       NA             1    /name</span></span>
<span><span class="co">## 3                       NA            -1   /price</span></span>
<span><span class="co">## 4                       NA             1  /tags/2</span></span>
<span><span class="co">## 5                     TRUE home, home, 1    /tags</span></span></code></pre>
<p>The names comes from within the <code>ajv</code> source, and may be annoying to work with programmatically.</p>
<p>There is also a simple interface where you take the schema and the json at the same time:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">json</span> <span class="op">&lt;-</span> <span class="st">'{</span></span>
<span><span class="st">    "id": 1,</span></span>
<span><span class="st">    "name": "A green door",</span></span>
<span><span class="st">    "price": 12.50,</span></span>
<span><span class="st">    "tags": ["home", "green"]</span></span>
<span><span class="st">}'</span></span>
<span><span class="fu">jsonvalidate</span><span class="fu">::</span><span class="fu"><a href="../reference/json_validate.html">json_validate</a></span><span class="op">(</span><span class="va">json</span>, <span class="va">schema</span>, engine <span class="op">=</span> <span class="st">"ajv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>However, this will be much slower than building the schema object once and using it repeatedly.</p>
<p>Prior to 1.4.0, the recommended way of building a reusable validator object was to use <code><a href="../reference/json_validator.html">jsonvalidate::json_validator</a></code>; this is still supported but note that it has different defaults to <code><a href="../reference/json_schema.html">jsonvalidate::json_schema</a></code> (using imjv for backward compatibility).</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu">jsonvalidate</span><span class="fu">::</span><span class="fu"><a href="../reference/json_validator.html">json_validator</a></span><span class="op">(</span><span class="va">schema</span>, engine <span class="op">=</span> <span class="st">"ajv"</span><span class="op">)</span></span>
<span><span class="fu">v</span><span class="op">(</span><span class="va">json</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>While we do not intend on removing this old interface, new code should prefer both <code><a href="../reference/json_schema.html">jsonvalidate::json_schema</a></code> and the <code>ajv</code> engine.</p>
<div class="section level2">
<h2 id="combining-schemas">Combining schemas<a class="anchor" aria-label="anchor" href="#combining-schemas"></a>
</h2>
<p>You can combine schemas with <code>ajv</code> engine. You can reference definitions within one schema</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">schema</span> <span class="op">&lt;-</span> <span class="st">'{</span></span>
<span><span class="st">  "$schema": "http://json-schema.org/draft-04/schema#",</span></span>
<span><span class="st">  "definitions": {</span></span>
<span><span class="st">    "city": { "type": "string" }</span></span>
<span><span class="st">  },</span></span>
<span><span class="st">  "type": "object",</span></span>
<span><span class="st">  "properties": {</span></span>
<span><span class="st">    "city": { "$ref": "#/definitions/city" }</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">}'</span></span>
<span><span class="va">json</span> <span class="op">&lt;-</span> <span class="st">'{</span></span>
<span><span class="st">    "city": "Firenze"</span></span>
<span><span class="st">}'</span></span>
<span><span class="fu">jsonvalidate</span><span class="fu">::</span><span class="fu"><a href="../reference/json_validate.html">json_validate</a></span><span class="op">(</span><span class="va">json</span>, <span class="va">schema</span>, engine <span class="op">=</span> <span class="st">"ajv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>You can reference schema from other files</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">city_schema</span> <span class="op">&lt;-</span> <span class="st">'{</span></span>
<span><span class="st">  "$schema": "http://json-schema.org/draft-07/schema",</span></span>
<span><span class="st">  "type": "string",</span></span>
<span><span class="st">  "enum": ["Firenze"]</span></span>
<span><span class="st">}'</span></span>
<span><span class="va">address_schema</span> <span class="op">&lt;-</span> <span class="st">'{</span></span>
<span><span class="st">  "$schema": "http://json-schema.org/draft-07/schema",</span></span>
<span><span class="st">  "type":"object",</span></span>
<span><span class="st">  "properties": {</span></span>
<span><span class="st">    "city": { "$ref": "city.json" }</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">}'</span></span>
<span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span>
<span><span class="va">address_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">path</span>, <span class="st">"address.json"</span><span class="op">)</span></span>
<span><span class="va">city_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">path</span>, <span class="st">"city.json"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">address_schema</span>, <span class="va">address_path</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">city_schema</span>, <span class="va">city_path</span><span class="op">)</span></span>
<span><span class="fu">jsonvalidate</span><span class="fu">::</span><span class="fu"><a href="../reference/json_validate.html">json_validate</a></span><span class="op">(</span><span class="va">json</span>, <span class="va">address_path</span>, engine <span class="op">=</span> <span class="st">"ajv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>You can combine schemas in subdirectories. Note that the <code>$ref</code> path needs to be relative to the schema path. You cannot use absolute paths in <code>$ref</code> and jsonvalidate will throw an error if you try to do so.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">user_schema</span> <span class="op">=</span> <span class="st">'{</span></span>
<span><span class="st">  "$schema": "http://json-schema.org/draft-07/schema",</span></span>
<span><span class="st">  "type": "object",</span></span>
<span><span class="st">  "required": ["address"],</span></span>
<span><span class="st">  "properties": {</span></span>
<span><span class="st">    "address": {</span></span>
<span><span class="st">      "$ref": "sub/address.json"</span></span>
<span><span class="st">    }</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">}'</span></span>
<span></span>
<span><span class="va">json</span> <span class="op">&lt;-</span> <span class="st">'{</span></span>
<span><span class="st">  "address": {</span></span>
<span><span class="st">    "city": "Firenze"</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">}'</span></span>
<span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">subdir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">path</span>, <span class="st">"sub"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">subdir</span>, showWarnings <span class="op">=</span> <span class="cn">FALSE</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">city_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">subdir</span>, <span class="st">"city.json"</span><span class="op">)</span></span>
<span><span class="va">address_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">subdir</span>, <span class="st">"address.json"</span><span class="op">)</span></span>
<span><span class="va">user_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">path</span>, <span class="st">"schema.json"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">city_schema</span>, <span class="va">city_path</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">address_schema</span>, <span class="va">address_path</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">user_schema</span>, <span class="va">user_path</span><span class="op">)</span></span>
<span><span class="fu">jsonvalidate</span><span class="fu">::</span><span class="fu"><a href="../reference/json_validate.html">json_validate</a></span><span class="op">(</span><span class="va">json</span>, <span class="va">user_path</span>, engine <span class="op">=</span> <span class="st">"ajv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
